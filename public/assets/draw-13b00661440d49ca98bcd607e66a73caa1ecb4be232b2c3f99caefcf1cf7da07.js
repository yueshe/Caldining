function add(t,a){return t+a}var curr_chart,food_list,calories_list,color_list,fat_list,carb_list;$(document).ready(draw);var draw=function(){food_list=[],calories_list=[],color_list=[],fat_list=[],carb_list=[],$("tr.food").each(function(){food_list.push($("td.name",this).text()),calories_list.push(parseFloat($("td.calories",this).html())*parseFloat($("td.servings",this).html())),carb_list.push(parseFloat($("td.carbs",this).html())*parseFloat($("td.servings",this).html())),fat_list.push(parseFloat($("td.fat",this).html())*parseFloat($("td.servings",this).html())),color_list.push("#"+Math.floor(16777215*Math.random()).toString(16))}),curr_chart=chart("#calories_chart",food_list,calories_list,color_list),$("#fat_div").hide(),$("#carb_div").hide(),$("#total_calories").text("Total Calories: "+calories_list.reduce(add,0)+"KCal"),$("#total_fat").text("Total Fat: "+fat_list.reduce(add,0)+"g"),$("#total_carb").text("Total Carbs: "+carb_list.reduce(add,0)+"g"),show()},chart=function(t,a,r,i){var l=$(t),o=new Chart(l,{type:"doughnut",data:{labels:a,datasets:[{data:r,backgroundColor:i,hoverBackgroundColor:i}]}});return o},show=function(){$("#chart_picker").change(function(){var t=$("#chart_picker").val();curr_chart.clear(),"calories"==t?($("#calories_div").fadeIn(),curr_chart=chart("#calories_chart",food_list,fat_list,color_list),$("#fat_div").hide(),$("#carb_div").hide()):"fat"==t?($("#fat_div").fadeIn(),curr_chart=chart("#fat_chart",food_list,fat_list,color_list),$("#calories_div").hide(),$("#carb_div").hide()):"carbs"==t&&($("#carb_div").fadeIn(),curr_chart=chart("#carb_chart",food_list,fat_list,color_list),$("#calories_div").hide(),$("#fat_div").hide())})};